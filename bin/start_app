#!/bin/bash

bundle check || bundle install

# This should transition to db:test:prepare eventually but I'm still dependent on seeds
if [ "$RAILS_ENV" = "test" ]
then
  bundle exec rails db:setup
fi

if [ "$RAILS_ENV" = "production" ]
then
  bundle exec rails assets:clean
  bundle exec rails assets:precompile
fi

bundle exec puma -C config/puma.rb
